{% extends "base.html" %}
{% block content %}
<div class="card p-4">
  <h3>Create Poll</h3>
  <form method="post" enctype="multipart/form-data">
    <div class="mb-3">
      <label class="form-label">Title</label>
      <input type="text" class="form-control" name="title" required>
    </div>

    <div class="mb-3">
      <label class="form-label">Description (optional)</label>
      <textarea class="form-control" name="description" rows="3"></textarea>
    </div>

    <div class="mb-3">
      <label class="form-label">Category</label>
      <select class="form-select" name="category">
        <option value="">Uncategorized</option>
        <option>Politics</option>
        <option>Sports</option>
        <option>Celebrity</option>
        <option>Tech</option>
        <option>Markets</option>
        <option>Science</option>
        <option>Entertainment</option>
        <option>Other</option>
      </select>
    </div>

    <div class="mb-3">
      <label class="form-label">Event Date (optional)</label>
      <input type="date" class="form-control" name="event_date">
    </div>

    <div class="mb-3">
      <label class="form-label">Image (optional)</label>
      <input type="file" class="form-control" name="image" accept="image/*">
    </div>

    <div class="mb-3">
      <label class="form-label">Options</label>
      <div id="option-list">
        <div class="input-group mb-2">
          <input type="text" name="options[]" class="form-control" placeholder="Option text" required>
          <button class="btn btn-outline-danger" type="button" onclick="removeOption(this)">✕</button>
        </div>
        <div class="input-group mb-2">
          <input type="text" name="options[]" class="form-control" placeholder="Option text" required>
          <button class="btn btn-outline-danger" type="button" onclick="removeOption(this)">✕</button>
        </div>
      </div>
      <button type="button" class="btn btn-sm btn-outline-primary" onclick="addOption()">+ Add option</button>
    </div>

    <button class="btn btn-success">Create Poll</button>
  </form>
</div>

<script>
  function addOption() {
    const list = document.getElementById('option-list');
    const el = document.createElement('div');
    el.className = 'input-group mb-2';
    el.innerHTML = `<input type="text" name="options[]" class="form-control" placeholder="Option text" required>
                    <button class="btn btn-outline-danger" type="button" onclick="removeOption(this)">✕</button>`;
    list.appendChild(el);
  }

  function removeOption(btn) {
    const wrapper = btn.closest('.input-group');
    if (!wrapper) return;
    const list = document.getElementById('option-list');
    // keep at least 2 options
    if (list.querySelectorAll('.input-group').length <= 2) {
      alert('At least two options required.');
      return;
    }
    wrapper.remove();
  }
</script>
{% endblock %}
